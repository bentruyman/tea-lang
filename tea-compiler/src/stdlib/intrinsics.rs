use super::{std_function, StdArity, StdFunction, StdFunctionKind, StdModule, StdType};
use crate::stdlib::std_module;

const INTRINSIC_FUNCTIONS: &[StdFunction] = &[
    // Type predicates - these map directly to intrinsic calls in AOT
    std_function(
        "is_nil",
        StdFunctionKind::UtilIsNil,
        StdArity::Exact(1),
        &[StdType::Any],
        StdType::Bool,
    ),
    std_function(
        "is_bool",
        StdFunctionKind::UtilIsBool,
        StdArity::Exact(1),
        &[StdType::Any],
        StdType::Bool,
    ),
    std_function(
        "is_int",
        StdFunctionKind::UtilIsInt,
        StdArity::Exact(1),
        &[StdType::Any],
        StdType::Bool,
    ),
    std_function(
        "is_float",
        StdFunctionKind::UtilIsFloat,
        StdArity::Exact(1),
        &[StdType::Any],
        StdType::Bool,
    ),
    std_function(
        "is_string",
        StdFunctionKind::UtilIsString,
        StdArity::Exact(1),
        &[StdType::Any],
        StdType::Bool,
    ),
    std_function(
        "is_list",
        StdFunctionKind::UtilIsList,
        StdArity::Exact(1),
        &[StdType::Any],
        StdType::Bool,
    ),
    std_function(
        "is_struct",
        StdFunctionKind::UtilIsStruct,
        StdArity::Exact(1),
        &[StdType::Any],
        StdType::Bool,
    ),
    std_function(
        "is_error",
        StdFunctionKind::UtilIsError,
        StdArity::Exact(1),
        &[StdType::Any],
        StdType::Bool,
    ),
    // Conversion
    std_function(
        "to_string",
        StdFunctionKind::UtilToString,
        StdArity::Exact(1),
        &[StdType::Any],
        StdType::String,
    ),
    // Assertions
    std_function(
        "fail",
        StdFunctionKind::AssertFail,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Void,
    ),
    // Environment
    std_function(
        "env_get",
        StdFunctionKind::EnvGet,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::String,
    ),
    std_function(
        "env_set",
        StdFunctionKind::EnvSet,
        StdArity::Exact(2),
        &[StdType::String, StdType::String],
        StdType::Void,
    ),
    std_function(
        "env_unset",
        StdFunctionKind::EnvUnset,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Void,
    ),
    std_function(
        "env_has",
        StdFunctionKind::EnvHas,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Bool,
    ),
    std_function(
        "env_vars",
        StdFunctionKind::EnvVars,
        StdArity::Exact(0),
        &[],
        StdType::Dict,
    ),
    std_function(
        "env_cwd",
        StdFunctionKind::EnvCwd,
        StdArity::Exact(0),
        &[],
        StdType::String,
    ),
    std_function(
        "env_set_cwd",
        StdFunctionKind::EnvSetCwd,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Void,
    ),
    std_function(
        "env_temp_dir",
        StdFunctionKind::EnvTempDir,
        StdArity::Exact(0),
        &[],
        StdType::String,
    ),
    std_function(
        "env_home_dir",
        StdFunctionKind::EnvHomeDir,
        StdArity::Exact(0),
        &[],
        StdType::String,
    ),
    std_function(
        "env_config_dir",
        StdFunctionKind::EnvConfigDir,
        StdArity::Exact(0),
        &[],
        StdType::String,
    ),
    // Filesystem
    std_function(
        "fs_read_text",
        StdFunctionKind::FsReadText,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::String,
    ),
    std_function(
        "fs_write_text",
        StdFunctionKind::FsWriteText,
        StdArity::Exact(2),
        &[StdType::String, StdType::String],
        StdType::Void,
    ),
    std_function(
        "fs_write_text_atomic",
        StdFunctionKind::FsWriteTextAtomic,
        StdArity::Exact(2),
        &[StdType::String, StdType::String],
        StdType::Void,
    ),
    std_function(
        "fs_create_dir",
        StdFunctionKind::FsCreateDir,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Void,
    ),
    std_function(
        "fs_remove",
        StdFunctionKind::FsRemove,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Void,
    ),
    std_function(
        "fs_exists",
        StdFunctionKind::FsExists,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Bool,
    ),
    std_function(
        "fs_is_dir",
        StdFunctionKind::FsIsDir,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Bool,
    ),
    std_function(
        "fs_is_symlink",
        StdFunctionKind::FsIsSymlink,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Bool,
    ),
    std_function(
        "fs_size",
        StdFunctionKind::FsSize,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Int,
    ),
    std_function(
        "fs_modified",
        StdFunctionKind::FsModified,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Int,
    ),
    std_function(
        "fs_permissions",
        StdFunctionKind::FsPermissions,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Int,
    ),
    std_function(
        "fs_is_readonly",
        StdFunctionKind::FsIsReadonly,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Bool,
    ),
    std_function(
        "fs_list_dir",
        StdFunctionKind::FsListDir,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::List,
    ),
    std_function(
        "fs_walk",
        StdFunctionKind::FsWalk,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::List,
    ),
    std_function(
        "fs_glob",
        StdFunctionKind::FsGlob,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::List,
    ),
    std_function(
        "fs_metadata",
        StdFunctionKind::FsMetadata,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Struct,
    ),
    // Path
    std_function(
        "path_join",
        StdFunctionKind::PathJoin,
        StdArity::Exact(1),
        &[StdType::List],
        StdType::String,
    ),
    std_function(
        "path_components",
        StdFunctionKind::PathComponents,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::List,
    ),
    std_function(
        "path_dirname",
        StdFunctionKind::PathDirname,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::String,
    ),
    std_function(
        "path_basename",
        StdFunctionKind::PathBasename,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::String,
    ),
    std_function(
        "path_extension",
        StdFunctionKind::PathExtension,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::String,
    ),
    std_function(
        "path_set_extension",
        StdFunctionKind::PathSetExtension,
        StdArity::Exact(2),
        &[StdType::String, StdType::String],
        StdType::String,
    ),
    std_function(
        "path_strip_extension",
        StdFunctionKind::PathStripExtension,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::String,
    ),
    std_function(
        "path_normalize",
        StdFunctionKind::PathNormalize,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::String,
    ),
    std_function(
        "path_absolute",
        StdFunctionKind::PathAbsolute,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::String,
    ),
    std_function(
        "path_relative",
        StdFunctionKind::PathRelative,
        StdArity::Exact(2),
        &[StdType::String, StdType::String],
        StdType::String,
    ),
    std_function(
        "path_is_absolute",
        StdFunctionKind::PathIsAbsolute,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Bool,
    ),
    std_function(
        "path_separator",
        StdFunctionKind::PathSeparator,
        StdArity::Exact(0),
        &[],
        StdType::String,
    ),
    // I/O
    std_function(
        "io_read_line",
        StdFunctionKind::IoReadLine,
        StdArity::Exact(0),
        &[],
        StdType::String,
    ),
    std_function(
        "io_read_all",
        StdFunctionKind::IoReadAll,
        StdArity::Exact(0),
        &[],
        StdType::String,
    ),
    std_function(
        "io_write",
        StdFunctionKind::IoWrite,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Void,
    ),
    std_function(
        "io_write_err",
        StdFunctionKind::IoWriteErr,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Void,
    ),
    std_function(
        "io_flush",
        StdFunctionKind::IoFlush,
        StdArity::Exact(0),
        &[],
        StdType::Void,
    ),
    // Process
    std_function(
        "process_run",
        StdFunctionKind::ProcessRun,
        StdArity::Exact(1),
        &[StdType::List],
        StdType::Struct,
    ),
    // Codecs
    std_function(
        "json_encode",
        StdFunctionKind::JsonEncode,
        StdArity::Exact(1),
        &[StdType::Any],
        StdType::String,
    ),
    std_function(
        "json_decode",
        StdFunctionKind::JsonDecode,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Any,
    ),
    std_function(
        "yaml_encode",
        StdFunctionKind::YamlEncode,
        StdArity::Exact(1),
        &[StdType::Any],
        StdType::String,
    ),
    std_function(
        "yaml_decode",
        StdFunctionKind::YamlDecode,
        StdArity::Exact(1),
        &[StdType::String],
        StdType::Any,
    ),
    // CLI
    std_function(
        "cli_args",
        StdFunctionKind::CliArgs,
        StdArity::Exact(0),
        &[],
        StdType::List,
    ),
];

pub const MODULE: StdModule = std_module!(
    "std.intrinsics",
    "Low-level intrinsic functions that provide native functionality",
    INTRINSIC_FUNCTIONS
);
